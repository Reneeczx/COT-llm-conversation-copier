# 开发笔记

## 问题与解决方案

### 1. CSS 样式污染
**问题描述**：全局 CSS 类名影响页面元素
**现象**：
- 页面标题和思考过程框高度变大
- 刷新页面后恢复正常
- 发生在弹窗注入时

**排查过程**
- 更细致地检查 "Styles" 和 "Computed" 面板 (关键！)
- 再次重现问题，保持弹窗打开。
- 在开发者工具 "Elements" 面板中， 非常仔细地 检查 "Thoughts" 框元素 (class 包含 container ng-star-inserted) 的 "Styles" 面板。 展开 "Styles" 面板中的 每一条 CSS 规则，查看它们的来源 (右侧会显示 CSS 文件的路径和行号)。
- 同时，再次查看 "Computed" 面板，确认 height: 250px 的值，并查看 "Computed" 面板中是否有任何线索，指示这个高度值是由哪个 CSS 规则计算出来的 (虽然 "Computed" 面板通常不直接显示规则来源，但有时会间接提供线索)。


**根本原因**：
- 使用了通用类名（.btn, .container）导致影响到页面元素
- 缺少 CSS 命名空间隔离

**解决方案**：
- 为所有选择器添加 #llm-copier-popup 命名空间前缀
- 移除通用类名
- 保持一致的 CSS 命名规范
- 去掉css文件中的!important

**经验总结**：
- 始终使用带命名空间的 CSS 选择器
- 添加新样式前检查现有样式
- 在不同平台上测试样式变化
- !important 的谨慎使用
- Chrome 开发者工具的强大作用： Chrome 开发者工具是排查 CSS 样式问题的利器，善用 "Elements" 和 "Computed" 面板可以帮助你快速定位问题。
- 逐步排查和耐心测试的重要性： 解决复杂问题往往需要耐心和细致的排查，一步一步缩小问题范围，最终找到根源。

## 最佳实践总结

### 1. 样式管理
- 使用唯一的命名空间前缀
- 遵循 BEM 命名规范
- 跨平台测试样式

### 2. 代码组织
- 模块化功能实现
- 清晰的文件结构
- 统一的代码风格

### 3. 调试技巧
- 使用 DevTools 分析问题
- 添加关键节点日志
- 系统性排查流程

## 待优化项目
- [ ] 优化弹窗定位逻辑
- [ ] 改进错误处理机制
- [ ] 添加单元测试
- [ ] 完善文档说明

## 技术债务记录
1. 部分 CSS 类名未完全遵循 BEM 规范
2. 需要添加更多调试日志 