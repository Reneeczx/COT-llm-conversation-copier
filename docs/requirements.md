# 项目名称: LLM Conversation Copier Chrome Extension

## 项目目标

开发一款 Chrome 浏览器扩展程序，旨在帮助用户方便快捷地复制大型语言模型 (LLM) 对话页面上的对话内容，以便于整理、归档或分享。该扩展程序能够：

- 批量选择并复制对话内容，包括用户提问、模型的思考过程（可选）以及最终回答。
- 将复制的内容输出为 Markdown 格式，并提供可选的 PDF 和图片输出，力求最大程度保留原文的格式风格。
- 提供灵活的选项设置，允许用户自定义是否包含模型思考过程，并进行批量选择。
- 最终目标是将该扩展程序上架至 Chrome 网上应用店，供用户安装使用。

## 功能需求

1. **对话内容选择与复制:**
    - 用户能够通过鼠标或键盘操作，在 LLM 对话页面上**批量多选**需要复制的对话单元。
    - 对话单元应包括：
        - **用户问题:** 用户向 LLM 提出的问题或指令。
        - **模型思考过程 (可选):**  LLM 在生成答案过程中产生的中间思考步骤或推理过程 (如果LLM界面提供)。**即使模型思考过程在 LLM 对话网页上默认是收起（折叠）状态，扩展程序也应能够识别并允许用户选中和复制这部分内容。**
        - **模型回答:** LLM 针对用户问题给出的最终回答。
    - 扩展程序应提供明确的视觉反馈，指示用户当前已选中的对话单元。
    - **严格保留原始时间线:**  复制的对话内容必须严格按照对话在原始页面上的时间顺序输出，确保对话的连贯性和逻辑性。  即使批量选择的对话单元在页面上可能不连续，输出时也需要按照它们在原始对话中的时间顺序排列。
    - 用户通过点击扩展程序图标或使用快捷键（待定），触发复制操作。

2. **输出格式与选项:**
    - **Markdown 输出 (必需):**
        - 将复制的对话内容输出为 Markdown 格式文本。
        - **保留原文格式:**  尽力将原文中的格式 (如 **加粗**, *斜体*, `代码块`, 列表, 引用等) 转换为 Markdown 语法。
        - **对话结构化:**  在 Markdown 输出中清晰地标识用户问题、模型思考过程和模型回答，例如使用不同的 Markdown 元素 (如引用块、标题等) 或分隔符。
    - **PDF 输出 (可选):**
        - 提供将复制内容导出为 PDF 文件的选项。
        - PDF 输出应尽可能保留原文的排版和格式，例如页面布局、字体、颜色等。
    - **图片输出 (可选):**
        - 提供将复制内容导出为图片 (例如 PNG 或 JPEG) 的选项。
        - 图片输出应捕获对话内容的可视化呈现，保留原文的样式和布局。
    - **思考过程选项:**
        - 提供一个全局设置选项，允许用户**默认选择**是否复制模型思考过程。
        - 在批量选择对话时，应提供选项，允许用户**批量选中或取消选中**已选对话中的模型思考过程部分。
        - 此选项应易于在扩展程序界面中访问和切换。

3. **用户界面 (UI) 与用户体验 (UX):**
    - **简洁易用:**  扩展程序界面应简洁直观，操作流程清晰易懂，即使是新手用户也能快速上手。
    - **Chrome Extension 标准 UI:**  采用符合 Chrome Extension 设计规范的 UI 元素和交互方式，例如弹出式 (Popup) 界面。
    - **图标与名称:**  设计易于识别的扩展程序图标和名称，方便用户在 Chrome 浏览器中找到和使用。
    - **设置选项:**  提供设置页面，用于配置输出选项 (是否包含思考过程、默认输出格式等)。
    - **用户反馈:**  在复制操作成功或失败时，提供适当的用户反馈 (例如，状态提示信息)。

4. **Chrome 网上应用店上架:**
    - 扩展程序的设计和开发应符合 Chrome 网上应用店的上架审核要求。
    - 需要准备符合要求的扩展程序描述、图标、截图等上架材料。
    - 考虑用户隐私和安全，最小化扩展程序所需的浏览器权限。

## 非功能需求

1. **性能:**
    - 复制操作应快速响应，避免长时间等待。
    - 扩展程序应尽量减少对浏览器性能的影响，避免占用过多资源。

2. **兼容性:**
    - **目标浏览器:**  Chrome 浏览器 (以及其他 Chromium 内核浏览器，如 Edge, Brave 等)。
    - **目标 LLM 平台 (初始):**  需要明确初始版本计划支持的 LLM 对话平台 (例如 OpenAI ChatGPT, Google Bard, Claude 等)。  未来应考虑扩展对更多平台的支持。
    - **页面结构适应性:**  扩展程序应具有一定的页面结构适应能力，能够应对不同 LLM 平台页面结构上的细微差异。  但初期可以针对特定平台进行优化。

3. **可靠性与稳定性:**
    - 扩展程序应稳定可靠地运行，避免崩溃或出现错误。
    - 在各种网络环境和页面条件下，复制功能应尽可能正常工作。
    - 考虑错误处理机制，当复制失败时，应给出友好的提示信息。

4. **安全性与隐私:**
    - **最小权限原则:**  扩展程序应仅申请完成功能所需的最小浏览器权限。
    - **数据安全:**  扩展程序不应收集、存储或上传用户的对话内容或任何个人信息。  所有处理应在用户本地浏览器端完成。
    - **代码安全:**  编写安全的代码，避免潜在的安全漏洞，确保用户使用安全。

5. **易维护性与可扩展性:**
    - 代码结构应清晰模块化，方便维护和升级。
    - 预留扩展接口，方便未来添加新的功能 (例如支持更多输出格式、更多 LLM 平台等)。

## 约束条件

1. **Chrome Extension API 限制:**  开发必须基于 Chrome Extension API 提供的功能和限制。
2. **目标 LLM 平台页面结构:**  扩展程序的功能实现依赖于目标 LLM 对话页面的 HTML 结构。  如果目标平台页面结构发生重大改变，可能需要更新扩展程序以适应。
3. **浏览器权限限制:**  为了用户安全和隐私，Chrome 浏览器对扩展程序权限有严格限制。  扩展程序应在权限范围内实现功能，并尽可能减少所需权限。
4. **开发语言:**  Chrome Extension 主要使用 JavaScript, HTML, CSS 等 Web 技术进行开发。

## 未来增强功能 (可选，但可考虑)

1. **自定义 Markdown 样式:**  允许用户自定义 Markdown 输出的样式，例如标题级别、分隔符、代码块样式等。
2. **更多输出格式:**  支持更多输出格式，例如纯文本、HTML、Word 文档等。
3. **平台自动检测与适配:**  扩展程序能够自动检测当前访问的 LLM 平台，并进行自适应调整，无需用户手动配置。
4. **对话内容编辑功能:**  在复制前，允许用户对选中的对话内容进行简单的编辑 (例如删除敏感信息、修改错别字等)。
5. **云同步与分享:**  将复制的对话内容同步到云端存储 (例如 Google Drive, Dropbox) 或直接分享到社交平台。
6. **快捷键自定义:**  允许用户自定义复制操作的快捷键。
7. **国际化 (i18n):**  支持多语言界面。

## 其他考虑情况

1. **用户群体定位:**  主要面向需要频繁与 LLM 进行对话，并需要整理和记录对话内容的个人用户、研究人员、内容创作者等。
2. **推广与用户获取:**  考虑如何推广你的 Chrome Extension，吸引用户安装和使用。  例如，可以通过社交媒体、技术博客、开发者社区等渠道进行宣传。
3. **用户反馈与迭代:**  在发布初期，积极收集用户反馈，并根据用户反馈进行迭代更新，不断改进扩展程序的功能和用户体验。

---

**修改说明:**

我在 **功能需求 - 1. 对话内容选择与复制** 部分，关于 "模型思考过程" 的描述中，加入了以下加粗语句：

> **即使模型思考过程在 LLM 对话网页上默认是收起（折叠）状态，扩展程序也应能够识别并允许用户选中和复制这部分内容。**

这段话明确了即使思考过程在页面上是收起的，扩展程序也需要能够处理并允许用户选中它。  这确保了用户可以完整地复制他们想要的内容，无论页面上的视觉呈现状态如何。

现在，这个需求文档应该更加全面和细致了。  希望对你有所帮助！